# qb-gascompany (QBCore)

سكريبت وظيفة مدنية متكامل لشركة الغاز في FiveM بنظام QBCore.

## المزايا
- نظام دوام كامل مع **شاحنة غاز مخصصة** لا تعمل إلا أثناء الدوام.
- مهام توصيل وتعبئة غاز للمنازل والمنشآت عبر NPC.
- نظام تفاعل مباشر عبر زر `E` بدون الحاجة إلى target.
- واجهة **NUI احترافية** لإدارة الدوام، الإحصائيات، والموظفين.
- صلاحيات مدير: متابعة الموظفين، عرض الحالة، وطرد الموظف.
- نظام رواتب: راتب أساسي + بونص على عدد المهام + مكافآت milestones.
- خصم تلقائي عند عدم إرجاع الشاحنة.
- Anti-Exploit أساسي (تحقق الوظيفة، تبريد طلب المهام، timeout).
- استخدام Props من اللعبة لإضفاء واقعية محطة التعبئة.

## البنية
```
qb-gascompany/
├─ fxmanifest.lua
├─ shared/config.lua
├─ client/
│  ├─ main.lua
│  ├─ target.lua
│  └─ nui.lua
├─ server/main.lua
└─ web/
   ├─ index.html
   ├─ style.css
   └─ app.js
```

## المتطلبات
- `qb-core`
- `ox_lib`
- `oxmysql`

## التثبيت
1. ضع مجلد `qb-gascompany` داخل `resources/[jobs]/`.
2. أضف `ensure qb-gascompany` في `server.cfg` بعد المتطلبات.
3. أضف وظيفة `gascompany` في `qb-core/shared/jobs.lua`.
4. عدّل `shared/config.lua` حسب سيرفرك (مواقع، رواتب، موديلات، إلخ).

## مثال وظيفة QBCore
```lua
['gascompany'] = {
    label = 'شركة الغاز',
    defaultDuty = false,
    offDutyPay = false,
    grades = {
        ['0'] = { name = 'متدرب', payment = 80 },
        ['1'] = { name = 'موظف', payment = 120 },
        ['2'] = { name = 'مشرف', payment = 160 },
        ['3'] = { name = 'نائب مدير', payment = 200 },
        ['4'] = { name = 'مدير', isboss = true, payment = 250 },
    }
}
```

## ملاحظات
- السكربت لا يحتوي أي أنظمة انفجار أو تسريب (حسب الطلب).
- يمكن ربطه لاحقاً مع أنظمة محاسبة/فاتورة أو هواتف RP بسهولة عبر أحداث السيرفر.
- الواجهة مبنية بطابع glassmorphism حديث مع أزرار كاملة الوظائف.

## حل مشكلة زر E لا يعمل
إذا ما ظهرت لك رسالة الضغط على E أو ما اشتغل التفاعل:
1. تأكد أن شخصية اللاعب وظيفتها `gascompany`.
2. تأكد أن السكربت بدأ فعلاً بدون أخطاء عند تشغيل السيرفر.
3. تأكد من ترتيب التشغيل في `server.cfg`: شغّل `qb-core` و `ox_lib` قبل `qb-gascompany`.
4. نفّذ `ensure qb-gascompany` بعد أي تعديل.
5. راقب F8/console لأي أخطاء Lua أو تعارض مفاتيح التحكم.


## التحكم (بدون Target)
- عند نقطة الشركة: `E` لبدء/إنهاء الدوام.
- عند نقطة الشركة: `Shift + E` لفتح لوحة الإدارة.
- عند موقف الشاحنة: `E` لاستلام الشاحنة.
- عند نقطة المهام: `E` لاستلام مهمة جديدة.
- عند نقطة الإرجاع: `E` لإرجاع الشاحنة.
- قرب المدني في المهمة: `E` للتفاعل (حديث > تعبئة > إنهاء).
- عند خلف الشاحنة: `E` لفتح/إغلاق خزان الشاحنة.


## إصلاح مشكلة عدم ظهور موقع المهمة
- تأكد أنك بدأت الدوام أولاً، لأن طلب المهمة الآن يتحقق من حالة الدوام على السيرفر.
- بعد الضغط على `E` في نقطة المهام، ستظهر رسالة تأكيد: `Mission request sent` ثم `Mission assigned`.
- إذا ظهرت مربعات بدل النص داخل GTA، هذا طبيعي أحياناً مع العربية في HelpText المدمج؛ تم تحويل رسائل التفاعل الأساسية إلى إنجليزية لتفادي المشكلة.
- لو ما ظهر أي موقع، راجع `Config.Missions.locations` وتأكد أنها ليست فارغة.
- إذا انطفت الشاحنة مباشرة وظهر خطأ "لا يوجد مفتاح": تم إضافة تسليم مفتاح تلقائي عند السباون، وتأكد أن مورد مفاتيح المركبات لديك يعمل (مثل qb-vehiclekeys).
